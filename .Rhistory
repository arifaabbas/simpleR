subset_select <- function(){
cat(bold("\n\nSubsetting Options"),
"\n\nDo you want to:
1. Remove specific variables
2. Keep specific variables
3. Remove specific observations
4. Keep specific observations", sep = "")
option <- readline("Type the number associated: ")
result <- options(option, c(1:4), manage_options("1"))
if(is.null(result$go)){
option <- result$option
subset_options(option)
}
}
subset_options <- function(option, df = e.super$df, dfname = e.super$dfname, variables = e.super$variables){
if(option == "1"){
cat(bold("\nRemove Specific Variables"))
varname("remove", subset_select())
if(!(is.null(variables))){
remove_vars()
subset_select()
}
}
if(option == "2"){
cat(bold("\nKeep Specific Variables"))
varname("only keep", subset("2"))
if(!(is.null(variables))){
keep_vars()
subset_select()
}
}
if(option == "3"){
cat(bold("\nRemove Specific Observations"))
varname("use as constraint(s)", subset_select())
if(!(is.null(variables))){
filtering()
}
}
if(option == "4"){
cat(bold("\nKeep Specific Observations"))
}
}
remove_vars <- function(variables = e.super$variables, df = e.super$df, dfname = e.super$dfname){
variablessplit <- strsplit(variables, " ")
variablessplit <- variablessplit[[1]]
e.super$df <- df %>%
select(-all_of(variablessplit))
assign(dfname[1], e.super$df, envir = .GlobalEnv)
}
keep_vars <- function(variables = e.super$variables, df = e.super$df, dfname = e.super$dfname){
variablessplit <- strsplit(variables, " ")
variablessplit <- variablessplit[[1]]
e.super$df <- df %>%
select(all_of(variablessplit))
assign(dfname[1], e.super$df, envir = .GlobalEnv)
}
filtering <- function(variables = e.super$variables, df = e.super$df, dfname = e.super$dfname){
variablessplit <- strsplit(variables, " ")
variablessplit <- variablessplit[[1]]
classes <- c("numeric", "factor", "character", "logical")
valid <- list()
filterit <- list()
for(i in variablessplit){
valid[[i]] <- class(df[[i]]) %in% classes}
if(!(FALSE %in% valid)){
for(i in variablessplit){
cat(bold("\nVariable = ", i), sep = "")
if(is.factor(i)){
cat("\nThis variable is a factor variable with ", length(levels(df[[i]])), "levels. The levels are:\n -",
paste(levels(df[[i]]), sep = "", collapse = "\n  - "),
"\nWhich level would you like to choose for filtering?", sep = "")
option <- readline("Type the name of the level: ")
option <- options(option, levels(df[, i]), backto)
filterit[[i]] <- fact(i)
}
else if(is.numeric(i)){
cat("\nThe range of your variable is: ", bold(range(df[[i]])[1], " - ", range(df[[i]])[2]),
"There are a few operations you can use.
Is the variable:
1. = : equal to a number
2. != : not equal to a number
3. > : greater than a number
4. >= : greater than or equal to a number
5. < : less than a number
6. <= : less than or equal to a number
7. between: between two numbers
8. outside: outside of two numbers", sep = "")
option <- readline("Type the number associated: ")
option <- options(option, 1:8, backto)
filterit[[i]] <- operation(i, option)
}
else if(is.character(i)){
cat("\nWould you like to filter using:
1. The whole string of an observation
2. A substring of an observation")
option <- readline("Type the number associated: ")
option <- options(option, 1:2, backto)
if(option == 1){
filterit[[i]] <- whole(i)
}
if(option == 2){
filterit[[i]] <- part(i)
}
}
else if(is.logical(i)){
cat("\nWhich observation would you like to choose for filtering?
1. TRUE
2. FALSE", sep = "")
option <- readline("Type the number associated: ")
option <- options(option, 1:2, backto)
filterit[[i]] <- logic(i, option)
}
}
}
else{
cat("\nOne or more of the variables you selected has a class that cannot be accommodated for", sep = "")
subset_select()
}
}
#_______________________________________________
# Change Vars:
changevar_select <- function(){
cat(bold("\nChange Existing Variables"),
"\n\nDo you want to:
1. Change variable class
2. Rename variable
3. Recode variable values")
option <- readline("Type the number associated: ")
result <- options(option, c(1:3), manage_select())
if(is.null(result$go)){
option <- result$option
changevar_options(option)
}
}
changevar_options <- function(option, df = e.super$df, dfname = e.super$dfname){
if(option == "1"){
cat(bold("\nChange Variable Class"))
varname("re-class", changevar_select(), solo = 1)
if(!(is.null(variables))){
changevar_class()
manage_select()}
}
if(option == "2"){
cat(bold("\nRename Variable"))
varname("rename", changevar_select(), solo = 1)
if(!(is.null(variables))){
changevar_name()
manage_select()}
}
if(option == "3"){
cat(bold("\nRecode Variable Values"))
varname("recode", changevar_select(), solo = 1)
if(!(is.null(variables))){
changevar_recode()
manage_select()}
}
}
changevar_class <- function(variables = e.super$variables, df = e.super$df, dfname = e.super$dfname) {
cat("\nWhat class would you like to change the variable(s) ", variables, "to?",
"
1. Numeric
2. Character
3. Logical
4. Factor")
option <- readline("Type the number associated: ")
result <- options(option, c(1:4), changevar_options(1))
if(is.null(result$go)){
option <- result$option
variablessplit <- strsplit(variables, " ")
variablessplit <- variablessplit[[1]]
if (option == 1){
temp <- list()
for (i in variablessplit){
if (length(na.omit(df[[i]])) == length(na.omit(as.numeric(df[[i]])))){
df[[i]] <- as.numeric(df[[i]])
}
else {
append(temp, i)
}
}
if(length(temp) > 0){
cat("Unfortunately these variables were not coerible into class numeric:", temp)
}
else {
cat("All specified variables were changed to class numeric")
}
}
if (option == 2){
for (i in variablessplit){
df[[i]] <- as.character(df[[i]])
}
cat("All specified variables were changed to class character")
}
if (option == 3){
temp <- list()
for (i in variablessplit){
try <- unique(na.omit(df[[i]]))
if (length(try) == 2){
for (n in 1:length(df[[i]])){
if (df[[i]][[n]] == try[1]){
df[[i]][[n]] <- FALSE
}
if (df[[i]][[n]] == try[2]){
df[[i]][[n]] <- TRUE
}
}
df[[i]] <- as.logical(df[[i]])
cat(try[1], "recoded as: FALSE\n", try[2], "recoded as: TRUE\n")
}
else {
append(temp, i)
}
}
if(length(temp) > 0){
cat("Unfortunately these variables were not coerible into class logical:", temp)
} else {
cat("All specified variables were changed to class logical")
}
}
if (option == 4){
cat("All specified variables were changed to class factor\nLevels:\n")
for (i in variablessplit){
df[[i]] <- as.factor(df[[i]])
cat(i,": ", levels(df[[i]]),"\n")
}
}
e.super$df <- df
assign(dfname[1], e.super$df, envir = .GlobalEnv)
}
}
changevar_name <- function(variables = e.super$variables, df = e.super$df, dfname = e.super$dfname, name = e.super$name) {
naming("variable", changevar_options(2))
if(!(is.null(e.super$name))){
e.super$df <- rename(df, name = variables)
assign(dfname[1], df, envir = .GlobalEnv)
}
}
changevar_recode <- function(variables = e.super$variables, df = e.super$df, dfname = e.super$dfname) {
cat("\nWhat value of ", variables, " would you like to recode?")
print(unique(df[[variables]]))
option <- readline("Type a valid variable response: ")
result <- options(option, unique(df[[variables]]), changevar_options(3))
if(is.null(result$go)){
option <- result$option
response <- readline("What would you like to recode: ")
go <- back(response, changevar_options(3))
if(is.null(go)){
for (i in 1:length(df[[variables]])){
if (df[[variables]][[i]] == option){
df[[variables]][[i]] <- response}
}
e.super$df <- df
assign(dfname[1], e.super$df, envir = .GlobalEnv)
cat(option," has now been recoded as ", response)
}
}
}
# 4. Analyse: -----------
super.mreg <- function(){
df <- e.super$df
plot.mreg <- function(x, points = FALSE, dot.size = 1, dot.alpha=.5, ci= TRUE, ...){
vars <- names(x$model)[names(x$model) != x$terms[[2]]]
myplots <- vector(mode="list", length=length(vars))
names(myplots) <- vars
for(i in vars){
myplots[[i]] <- plot(ggeffect(x, i), add.data=points,
dot.size=dot.size, dot.alpha=dot.alpha, ci=ci, ...)+ labs(title="")
}
final <- wrap_plots(myplots) + plot_annotation(title="Effects Plots",
subtitle="Each variables bilateral relationship controlling for the others")
return(final)
}
mreg <- function(formula, df){
fit <- lm(formula, df)
fit$call <- str2lang(paste("lm(formula=", deparse(substitute(formula)),
", data=", deparse(substitute(df)), ")"))
class(fit) <- c("mreg", "lm")
return(fit)
}
#Introduction to reg ----
repeat{
cat(underline("Welcome to conducting a multiple regression!\n"),
"Would you like a brief overview of what a multiple regression entails?\n",
"  1.", green(" Yes\n"),
"  2.", red(" No"),sep="")
overview <- readline("Please enter the number associated with the option:")
result <- options(overview, 1:2, main())
if(!(is.null(result$go))){break}
overview <- result$option
if (overview == 1){
cat(underline(green("\nMultiple linear regression")), " also known simply as multiple regression, is a statistical technique
that uses ", bold("several explanatory variables"), " (i.e predictor variables or independent variables) to
predict the outcome of a ", bold("response variable"), " (i.e predicted variable or dependent variable).
\nMultiple regression is an extension of simple linear regression as you can input more than one
explanatory variable that gives you a better and more in-depth analysis.\n",
green("\nIn summary"), ", multiple regression will allow you to see how the explanatory variables are affecting
the response variables, which is useful in trying to make conclusions regarding certain hypothesis.", sep="")
}
cat("\n----------------------------------------------------------------------------------------------------------------",sep="")
cat(bold(red("\nNote:")), " Please ensure all variables that will be used in this regression have",
red$bold(" no missing values"), " and are the \nsuitable type and class for the multiple regression to provide meaningful results.","\n",
"\n> If at any point you want to go back to the main menu just type: ", green("!!!"), sep="")
cat("\n----------------------------------------------------------------------------------------------------------------",sep="")
cat("\nNow you will be asked to input the variable you want to predict (i.e response/dependent variable).", "\n",
"Please ensure you enter the ", bold(red("exact name")), " of this variable.", sep = "")
#Input dependent variable ----
repeat{
dv <- readline("Enter dependent variable name here and hit return:")
go <- back(dv, main())
if(!(is.null(go))){break}
if(length(setdiff(dv, names(df))) > 0){
cat("\n'", bold(underline((setdiff(dv, names(df))))),"'", " is an", bold(red(" invalid"))," variable that is not in the dataset"," '", blue(e.super$dfname),"'", "\n",
"\nPlease input a variable that is in the dataset"," '", blue(e.super$dfname),"'", sep = "")
}
else{
input1 <- dv
cat("\nThanks! The variable you chose is: ", bold(input1),"\n", sep="")
break
}
}
if(!(is.null(go))){break}
cat("\nNow you will be asked to enter the ", bold(red("exact name")), " of the explanatory variables (i.e independent/predictor)
that will be tested against the response variable.\n", sep="")
#Input independent variable ----
repeat{
iv <- readline("Please enter the independent variables seperated by a space:")
go <- back(iv, main())
if(!(is.null(go))){break}
iv <- strsplit(iv, " ")
iv <- iv[[1]]
if (length(setdiff(iv, names(df))) > 0){
cat("\nThe following variables are ", bold(red("invalid ")),"as they are not in the dataset"," '", blue(e.super$dfname),"':","\n",
underline(bold(setdiff(iv, names(df)))),"\n\n",
"Please input a variable that is in the dataset"," '", blue(e.super$dfname),"'", sep = "")
}else{
input2 <- iv
cat("\nThanks! The variables you chose are: ", bold(input2), sep="")
break
}
}
#Results ----
if(!(is.null(go))){break}
cat(green(bold(underline("\nHere are the results for the multiple regression:"))))
ls <- input1
rs <- paste(input2, collapse="+")
f <- paste(ls, "~", rs)
formula <- as.formula(f)
fit <- mreg(formula, df)
print(summary.lm(fit))
results <- summary.lm(fit)$coefficients
cat(underline("Do you need help understanding the", bold("output and significance"), "of the above regression?"),"\n",
"  1.", green(" Yes\n"),
"  2.", red(" No"),sep="")
select <- readline("Please enter the number associated with the option:")
result <- options(select, 1:2, main())
if(!(is.null(result$go))){break}
select <- result$option
if (select == 1){
cat(underline("\nHere are the ", bold(blue("significant results")), " where the p value was less than 0.05:"),"\n\n", sep = "")
for(i in 2:nrow(results)){
if(results[i, 4] < .05){
cat("For a 1 point change in ",  bold(dimnames(results)[[1]][i]),
", ", blue(input1), " is expected to change by ", red(results[i, 1]),".\n", sep = "")
}
}
}
repeat{
cat("\n",underline("Additionally, do you want to do any of the following?"),"\n",
" 1.", blue("Understand the ", bold("R-squared value and Adjusted R-squared"), " value\n"),
" 2.", green("Get ", bold("plots of each paired relationship"), " between the dependent and each independent variable\n"),
" 3.", magenta("Get the ", bold("relative importance"), " of each variable in your model\n"),
" 4.", yellow("Go back to the ", bold("main menu"), sep=""))
input <-  readline("Please enter the number associated with the option:")
result <- options(input, 1:4, main())
if(!(is.null(result$go))){break}
input <- result$option
#R and Adjust R squared analysis ----
if (input == 1){
r.s <- summary.lm(fit)$r.squared
ars <- summary.lm(fit)$adj.r.squared
cat(red("\nThe R-squared value for this analysis is "), bold(r.s),
"\n> The R-squared value explains the degree to which your explanatory variables explains the variation
of your response variable.\n> So an R-squared value of ", r.s," means that ",(r.s)*100,"%"," of the variation in the response variable
is explained by the explanatory variables in the analysis.","\n\n", sep ="")
cat(red("The Adjusted-R squared value for this analysis is "), bold(ars),
"\nThe Adjusted R-squared increases when new terms improve the model more than would be expected by chance and
it decreases when a explanatory variable improves the model by less than expected.
> The Adjusted R-squared helps to determine how much of the significance is just due to addition of
explanatory variables.
> The adjusted R-squared compensates for the addition of variables and only increases if the new
explanatory added enhances the model above what would be obtained by probability. Conversely, it will
decrease when a explanatory variable improves the model less than what is predicted by chance\n", sep="")
}
# Mreg Plots ----
if (input == 2){
cat(bold(blue(underline(("\nOn the right is the plots! >>>>")))))
cat("\n>These plots", bold(" show the relationship of response to each explanatory variable seperately"), " so that you can
understand the relationship between each response varibale and explanatory variables better.\n", sep="")
p <- plot.mreg(fit, points=TRUE)
print(p)
}
# General dominance plots ----
if (input == 3){
cat(bold(magenta(underline("\nOn the right is your general dominance plot! >>>>"))),
"\nThis plot shows you the ", bold("average importance of each explanatory variable"), " relative to all the other
explanatory variables included in the multiple regression.\n", sep="")
rela_fit <- lm(formula, mtcars)
da_df <- dominanceAnalysis(rela_fit)
rp <- plot(da_df) +
labs(x = "Variable Name",
y = "Relative Importance",
title = "General Dominance Plot of Response Variables in Analysis")+
coord_flip() +
theme(legend.position= "none")
print(rp)
}
if (input == 4){
cat()
main()
break
}
}
if(!(is.null(result$go))){break}
}
}
df_select()
}
arifa <- mtcars
super()
library(crayon)
super()
library(usethis)
use_mit_license("Arifa Abbas, Neve Oren, Lars Delin")
use_package(“dplyr”)
use_package(“crayon”)
use_package(“stats”)
use_package(“ggeffects”)
use_package(“ggplot2”)
use_package(“patchwork”)
use_package(“dominanceanalysis”)
use_package(“effects”)
library(usethis)
use_package(“dplyr”)
use_package(“crayon”)
use_package(“stats”)
use_package(“ggeffects”)
use_package(“ggplot2”)
use_package(“patchwork”)
use_package(“dominanceanalysis”)
use_package(“effects”)
library("dplyr")
library("crayon")
library("stats")
library("ggeffects")
library("ggplot2")
library("patchwork")
library("dominanceanalysis")
library("effects")
library("dplyr")
library("crayon")
library("stats")
library("ggeffects")
library("ggplot2")
library("patchwork")
library("dominanceanalysis")
library("effects")
use_package("dplyr")
use_package("dominanceanalysis")
use_package("crayon")
use_package("stats")
use_package("ggeffects")
use_package("ggplot2")
use_package("effects")
use_package("patchwork")
library(simpleR)
simple()
?simpleR
?simple
library(simpleR)
?simple
library(simpleR)
library(pkgdown)
build_site()
library(usethis)
use_vignette("simpleR", "Using simpleR)
library(usethis)
use_vignette("simpleR", "Using simpleR")
remotes::install_github("simpleR"")
remotes::install_github("simpleR")
use_github_links()
library(devtools)
use_github_links()
library(pkgdown)
build_site()
library(usethis)
use_vignette("simpleR","Using simpleR")
library(simpleR)
?simple
vignette("simpleR")
vignette(simpleR)
vignette("simpleR")
vignette("simpleR")
build_site()
library(simpleR)
build_site()
library(pkgdown)
build_site()
library(usethis)
use_vignette("simpleR", "Using simpleR")
setwd("~/Desktop/simpleR")
use_vignette("simpleR", "Using simpleR")
use_vignette("simpleR", "Using simpleR")
